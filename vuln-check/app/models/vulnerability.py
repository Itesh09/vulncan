from typing import Dict, Any

Vulnerability = Dict[str, Any]
"""
Represents a single identified vulnerability. This is intended to be the
standardized output format for all individual scanners.

Expected keys:
- 'vulnerability_type': str (e.g., 'xss', 'sql_injection', 'insecure_headers')
- 'is_vulnerable': bool (True if the vulnerability is detected, False otherwise)
- 'severity': str (e.g., 'critical', 'high', 'medium', 'low', 'info')
- 'confidence': float (0.0 to 1.0, indicating the likelihood of the finding)
- 'evidence': Any (e.g., list of strings, dictionary, often details about *why* it's vulnerable)
- 'recommendation': str (Actionable advice to remediate the vulnerability)
- 'scanner_name': str (Optional, to identify which scanner produced the result)
"""

def create_vulnerability_entry(
    vulnerability_type: str,
    is_vulnerable: bool,
    severity: str,
    confidence: float,
    evidence: Any,
    recommendation: str,
    scanner_name: str = None
) -> Vulnerability:
    """
    Helper function to create a standardized vulnerability dictionary.
    """
    return {
        "vulnerability_type": vulnerability_type,
        "is_vulnerable": is_vulnerable,
        "severity": severity,
        "confidence": confidence,
        "evidence": evidence,
        "recommendation": recommendation,
        "scanner_name": scanner_name
    }
